(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{665:function(s,a,t){s.exports=t.p+"assets/img/逻辑卷组成.0a15fa9e.png"},813:function(s,a,t){"use strict";t.r(a);var n=t(6),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"逻辑卷"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#逻辑卷"}},[s._v("#")]),s._v(" 逻辑卷")]),s._v(" "),n("p",[s._v("许多 Linux 使用者安装操作系统时都会遇到这样的困境：如何精确评估和分配各个硬盘分区的容量，如果当初评估不准确，一旦系统分区不够用时可能不得不备份、删除相关数据，甚至被迫重新规划分区并重装操作系统，以满足应用系统的需要。")]),s._v(" "),n("blockquote",[n("p",[s._v("比如很多人在使用"),n("code",[s._v("win")]),s._v("的时候，都会遇见"),n("code",[s._v("C盘分小了")]),s._v("的情况，磁盘不够用！")])]),s._v(" "),n("p",[n("strong",[s._v("这个时候使用就要使用逻辑卷技术了！")])]),s._v(" "),n("h2",{attrs:{id:"_1-逻辑卷简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-逻辑卷简介"}},[s._v("#")]),s._v(" 1. 逻辑卷简介")]),s._v(" "),n("p",[s._v("LVM 将"),n("strong",[s._v("存储虚拟化")]),s._v("，使用逻辑卷，你不会受限于物理磁盘的大小，另外,与硬件相关的存储设置被其隐藏，你可以不用停止应用或卸载文件系统来调整卷大小或数据迁移，这样可以减少操作成本。")]),s._v(" "),n("p",[n("strong",[s._v("逻辑卷相比物理卷的优点：")])]),s._v(" "),n("ul",[n("li",[s._v("灵活的容量")]),s._v(" "),n("li",[s._v("可伸缩的存储池")]),s._v(" "),n("li",[s._v("在线数据迁移")]),s._v(" "),n("li",[s._v("方便的设备命名")]),s._v(" "),n("li",[s._v("磁盘条块化")]),s._v(" "),n("li",[s._v("提供如镜像卷，快照卷，精简缓存卷等多种类型和功能的卷")])]),s._v(" "),n("h2",{attrs:{id:"_2-逻辑卷的组成"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-逻辑卷的组成"}},[s._v("#")]),s._v(" 2. 逻辑卷的组成")]),s._v(" "),n("p",[n("strong",[s._v("块设备（block）")])]),s._v(" "),n("div",{staticClass:"language-markdown line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-markdown"}},[n("code",[n("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 硬盘\n"),n("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 分区\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("物理卷 Physical volume(PV)")])]),s._v(" "),n("div",{staticClass:"language-markdown line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-markdown"}},[n("code",[n("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 物理卷在逻辑卷管理系统最底层，LVM 逻辑卷要使用这些设备，这些设备必需要被初始化为 PV\n"),n("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 我们实际的 partition （或 Disk） 需要调整系统识别码 （system ID） 成为 8e （LVM 的识别码）\n"),n("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 使用 gdisk/fdisk 创建\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("blockquote",[n("p",[s._v("将一个磁盘做成 PV 之后，该磁盘的数据就丢了。")])]),s._v(" "),n("p",[n("strong",[s._v("卷组 Volume group (VG)")])]),s._v(" "),n("div",{staticClass:"language-markdown line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-markdown"}},[n("code",[n("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 许多个物理卷组成卷组。这样创建了一个硬盘空间池可供逻辑卷使用。\n"),n("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" VG 就是 LVM 组合起来的大磁盘！\n"),n("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" LVM 默认使用 4MB 的 PE 区块，而 LVM 的 LV 在 32 位系统上最多仅能含有 65534 个 PE （lvm1 的格式），因此默认的 LVM 的 LV 会有 4M\\*65534/（1024M/G）=256G（限于 lvm1 版本）。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("blockquote",[n("p",[n("strong",[s._v("物理区域 Physical extent (PE)")]),s._v("：逻辑卷最小单位，具有唯一编号，可以被 LVM 寻址。")])]),s._v(" "),n("p",[n("strong",[s._v("逻辑卷 Logical volume (LV)")])]),s._v(" "),n("div",{staticClass:"language-markdown line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-markdown"}},[n("code",[n("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 虚拟分区，由物理区域（physical extents）组成。\n"),n("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 由大 VG 切分而成\n"),n("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("-")]),s._v(" 支持在线扩展，不影响业务，可以进行快照，还原\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[n("img",{attrs:{src:t(665),alt:"逻辑卷组成"}})]),s._v(" "),n("h2",{attrs:{id:"_3-制作逻辑卷"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-制作逻辑卷"}},[s._v("#")]),s._v(" 3. 制作逻辑卷")]),s._v(" "),n("h3",{attrs:{id:"_3-1-做成-pv"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-做成-pv"}},[s._v("#")]),s._v(" 3.1. 做成 PV")]),s._v(" "),n("p",[s._v("对磁盘分区")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("fdisk")]),s._v(" /dev/sdb\n\n 分出下面sdb1，sdb2两个分区\nCommand "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": p\n\nDisk /dev/sdb: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("107.4")]),s._v(" GB, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("107374182400")]),s._v(" bytes, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("209715200")]),s._v(" sectors\nUnits "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nDisk label type: dos\nDisk identifier: 0x8b10ccd0\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sdb1            "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10487807")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5242880")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v("  Linux\n/dev/sdb2        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10487808")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("31459327")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10485760")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v("  Linux\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("将标识更改标识为"),n("code",[s._v("Linux LVM")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v(" sdb1，sdb2都改为8e标识\nCommand "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": t\nPartition number "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1,2")]),s._v(", default "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nHex code "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type L to list all codes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 8e\nChanged "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" of partition "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Linux'")]),s._v(" to "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Linux LVM'")]),s._v("\n\nCommand "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": p\n\nDisk /dev/sdb: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("107.4")]),s._v(" GB, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("107374182400")]),s._v(" bytes, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("209715200")]),s._v(" sectors\nUnits "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nDisk label type: dos\nDisk identifier: 0x64427aee\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sdb1            "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10487807")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5242880")]),s._v("   8e  Linux LVM\n/dev/sdb2        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10487808")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("31459327")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10485760")]),s._v("   8e  Linux LVM\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[s._v("最后保存分区")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("Command "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": w\nThe partition table has been altered"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\nCalling ioctl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to re-read partition table.\nSyncing disks.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("做成 PV，并查看")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ pvcreate /dev/sdb1\n  Physical volume "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/sdb1"')]),s._v(" successfully created.\n$ pvcreate /dev/sdb2\n  Physical volume "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/sdb2"')]),s._v(" successfully created.\n\n  查看物理卷\n$ pvdisplay\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"_3-2-做成-vg"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-做成-vg"}},[s._v("#")]),s._v(" 3.2. 做成 VG")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ vgcreate vg0 /dev/sdb1 /dev/sdb2\n  Volume group "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vg0"')]),s._v(" successfully created\n\n  查看卷组\n$ vgdisplay\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_3-3-做成-lv"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-做成-lv"}},[s._v("#")]),s._v(" 3.3. 做成 LV")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ lvcreate -L 8G -n lv0 vg0\n  Logical volume "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lv0"')]),s._v(" created.\n\n  查看逻辑卷\n$ lvdisplay\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"_4-使用逻辑卷"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-使用逻辑卷"}},[s._v("#")]),s._v(" 4. 使用逻辑卷")]),s._v(" "),n("p",[s._v("要使用，跟普通文件系统一样，格式化即可。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ mkfs.ext4 /dev/vg0/lv0\nmeta-data"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/vg0/lv0           "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("isize")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("agcount")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("agsize")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("524288")]),s._v(" blks\n         "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sectsz")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("attr")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("projid32bit")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("crc")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("finobt")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sparse")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndata     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097152")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("imaxpct")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sunit")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("swidth")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" blks\nnaming   "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("version "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("              "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   ascii-ci"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ftype")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog      "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("internal log           "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2560")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sectsz")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sunit")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" blks, lazy-count"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nrealtime "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("none                   "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("extsz")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rtextents")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("然后挂载在一个目录")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" /dev/vg0/lv0 /data/\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" -h\nFilesystem               Size  Used Avail Use% Mounted on\n/dev/mapper/vg0-lv0      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".0G   33M  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".0G   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /data\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("blockquote",[n("p",[s._v("是"),n("code",[s._v("/dev/mapper/vg0-lv0")]),s._v(" 是一个链接（l）设备")])]),s._v(" "),n("p",[s._v("开机自动挂载，写入"),n("code",[s._v("/etc/fstab")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/vg0/lv0      /data         xfs     defaults 0 0"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("/etc/fstab\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"_5-逻辑卷扩容"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-逻辑卷扩容"}},[s._v("#")]),s._v(" 5. 逻辑卷扩容")]),s._v(" "),n("blockquote",[n("p",[s._v("首先使用"),n("code",[s._v("dd")]),s._v("命令配合"),n("code",[s._v("/dev/zero")]),s._v("命令模拟"),n("code",[s._v("/data")]),s._v("空间不够")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dd")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("if")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/zero "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("of")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/data/test5 "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bs")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1M "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("count")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7168")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" -h\nFilesystem               Size  Used Avail Use% Mounted on\n/dev/mapper/vg0-lv0      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".0G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".1G  982M  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("89")]),s._v("% /data\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[n("strong",[s._v("扩容步骤：")])]),s._v(" "),n("h3",{attrs:{id:"_5-1-查看逻辑卷所在的卷组"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-查看逻辑卷所在的卷组"}},[s._v("#")]),s._v(" 5.1. 查看逻辑卷所在的卷组")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ vgdisplay vg0\n  --- Volume group ---\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n  Free  PE / Size       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1790")]),s._v(" / "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.99")]),s._v(" GiB\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从这里可以看到，还剩下7G")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("blockquote",[n("p",[s._v("假设现在需要扩容 10G，原本的 7G 是不够扩的。")])]),s._v(" "),n("h3",{attrs:{id:"_5-2-分一个-dev-sdb3-分区"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-分一个-dev-sdb3-分区"}},[s._v("#")]),s._v(" 5.2. 分一个/dev/sdb3 分区")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("fdisk")]),s._v(" /dev/sdb\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("Command "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": p\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sdb3        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("31459328")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("52430847")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10485760")]),s._v("   8e  Linux LVM\nCommand "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": w\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_5-3-做成-pv-加入-vg-中"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-做成-pv-加入-vg-中"}},[s._v("#")]),s._v(" 5.3. 做成 PV，加入 VG 中")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ pvcreate /dev/sdb3\n  Physical volume "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/sdb3"')]),s._v(" successfully created.\n\n$ vgextend vg0 /dev/sdb3\n  Volume group "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vg0"')]),s._v(" successfully extended\n$ vgdisplay vg0\n  --- Volume group ---\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n  Free  PE / Size       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4349")]),s._v(" / "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16.99")]),s._v(" GiB\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#还剩17G，扩容Vg成功")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h3",{attrs:{id:"_5-4-扩容-lv"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-扩容-lv"}},[s._v("#")]),s._v(" 5.4. 扩容 LV")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ lvextend -L +10G /dev/vg0/lv0\n  Size of logical volume vg0/lv0 changed from "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.00")]),s._v(" GiB "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v(" extents"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.00")]),s._v(" GiB "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4608")]),s._v(" extents"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n  Logical volume vg0/lv0 successfully resized.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ lvdisplay\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n  --- Logical volume ---\n  LV Path                /dev/vg0/lv0\n  LV Name                lv0\n  VG Name                vg0\n  LV UUID                jNXzjd-P5HZ-UWLk-kWzQ-6wj7-ViYR-2o4odz\n  LV Write Access        read/write\n  LV Creation host, "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" localhost.localdomain, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-09-21 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":38:41 +0800\n  LV Status              available\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# open                 1")]),s._v("\n  LV Size                "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.00")]),s._v(" GiB\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#扩容成功，由8G扩为18G")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h3",{attrs:{id:"_5-5-扩展文件系统"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-扩展文件系统"}},[s._v("#")]),s._v(" 5.5. 扩展文件系统")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" -h\nFilesystem               Size  Used Avail Use% Mounted on\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n/dev/mapper/vg0-lv0      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".0G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".1G  982M  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("89")]),s._v("% /data\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#发现/data并没有扩容")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("blockquote",[n("p",[s._v("原因是新加入的 10G 没有格式化！没有格式化没有文件系统怎么可以使用呢？")])]),s._v(" "),n("p",[s._v("执行调整")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ resize2fs /dev/vg0/lv0\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" -h\nFilesystem               Size  Used Avail Use% Mounted on\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n/dev/mapper/vg0-lv0       18G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".1G   11G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v("% /data\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("blockquote",[n("p",[n("strong",[s._v("resize2fs")]),s._v(" 命令 针对的是 ext2、ext3、ext4 文件系统\n"),n("strong",[s._v("xfs_growfs")]),s._v(" 命令 针对的是 xfs 文件系统")])]),s._v(" "),n("h2",{attrs:{id:"_6-逻辑卷缩容"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-逻辑卷缩容"}},[s._v("#")]),s._v(" 6. 逻辑卷缩容")]),s._v(" "),n("blockquote",[n("ul",[n("li",[s._v("一定要停掉业务，最好进行备份")]),s._v(" "),n("li",[s._v("xfs 不支持缩容，强行缩容后，需要格式化后才能挂载")])])]),s._v(" "),n("p",[s._v("缩小"),n("code",[s._v("/data")]),s._v("，先弄一点文件在 data 目录下，模拟资源数据")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" /data/\nBzm  etc  lost+found  test5\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"_6-1-取消挂载"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-取消挂载"}},[s._v("#")]),s._v(" 6.1. 取消挂载")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("umount")]),s._v(" /data\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"_6-2-扫描逻辑卷"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-扫描逻辑卷"}},[s._v("#")]),s._v(" 6.2. 扫描逻辑卷")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ e2fsck -f /dev/vg0/lv0\ne2fsck "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.42")]),s._v(".9 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("-Dec-2013"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nPass "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": Checking inodes, blocks, and sizes\nPass "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(": Checking directory structure\nPass "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(": Checking directory connectivity\nPass "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(": Checking reference counts\nPass "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(": Checking group summary information\n/dev/vg0/lv0: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("/1310720 files "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("% non-contiguous"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1961320")]),s._v("/5242880 blocks\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"_6-3-缩小文件系统"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-缩小文件系统"}},[s._v("#")]),s._v(" 6.3. 缩小文件系统")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ resize2fs /dev/vg0/lv0 10G\nresize2fs "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.42")]),s._v(".9 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("-Dec-2013"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nResizing the filesystem on /dev/vg0/lv0 to "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2621440")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("4k"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" blocks.\nThe filesystem on /dev/vg0/lv0 is now "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2621440")]),s._v(" blocks long.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"_6-4-逻辑卷缩小"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-逻辑卷缩小"}},[s._v("#")]),s._v(" 6.4. 逻辑卷缩小")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("$ lvreduce -L 10G /dev/vg0/lv0\n  WARNING: Reducing active logical volume to "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.00")]),s._v(" GiB.\n  THIS MAY DESTROY YOUR DATA "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filesystem etc."),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nDo you really want to reduce vg0/lv0? "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("y/n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": y\n  Size of logical volume vg0/lv0 changed from "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.00")]),s._v(" GiB "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5120")]),s._v(" extents"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.00")]),s._v(" GiB "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2560")]),s._v(" extents"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n  Logical volume vg0/lv0 successfully resized.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"_6-5-检查缩容结果"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-检查缩容结果"}},[s._v("#")]),s._v(" 6.5. 检查缩容结果")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ lvdisplay\n  --- Logical volume ---\n  LV Path                /dev/vg0/lv0\n  LV Name                lv0\n  VG Name                vg0\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n  LV Size                "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.00")]),s._v(" GiB\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#缩为10G")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("重新挂载，查看文件是否存在")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" -a\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" /data/\nBzm  etc  lost+found  test5\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("blockquote",[n("p",[s._v("缩小，只要缩小后的逻辑卷大小比数据占用的空间大，一般不会丢失。")])]),s._v(" "),n("h2",{attrs:{id:"_7-更换物理卷"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-更换物理卷"}},[s._v("#")]),s._v(" 7. 更换物理卷")]),s._v(" "),n("blockquote",[n("p",[s._v("必须在同一个卷组中，而且移动后的设备必须要大于等于之前设备")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ pvdisplay\n  --- Physical volume ---\n  PV Name               /dev/sdb1\n  VG Name               vg0\n  PV Size               "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.00")]),s._v(" GiB / not usable "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.00")]),s._v(" MiB\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n  --- Physical volume ---\n  PV Name               /dev/sdb2\n  VG Name               vg0\n  PV Size               "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.00")]),s._v(" GiB / not usable "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.00")]),s._v(" MiB\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n  --- Physical volume ---\n  PV Name               /dev/sdb3\n  VG Name               vg0\n  PV Size               "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.00")]),s._v(" GiB / not usable "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.00")]),s._v(" MiB\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("blockquote",[n("p",[s._v("查看物理卷 PV 发现，10G 都是使用的，"),n("code",[s._v("/dev/sdb2")]),s._v("，如果遇到什么情况需要更换它，但是又不能影响业务。")])]),s._v(" "),n("h3",{attrs:{id:"_7-1-新的磁盘加入卷组-vg"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-新的磁盘加入卷组-vg"}},[s._v("#")]),s._v(" 7.1. 新的磁盘加入卷组 VG")]),s._v(" "),n("blockquote",[n("p",[s._v("加入过程略...")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ vgdisplay vg0 -v\n  --- Volume group ---\n  VG Name               vg0\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n  VG Size               "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("34.98")]),s._v(" GiB\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n  --- Physical volumes ---\n  PV Name               /dev/sdb1\n  PV UUID               eGfgMo-J9AX-U9kr-rVuV-UCp0-uv5c-AIsIru\n  PV Status             allocatable\n  Total PE / Free PE    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1279")]),s._v(" / "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1279")]),s._v("\n\n  PV Name               /dev/sdb2\n  PV UUID               1Dg6Kw-kzUe-3o0p-lhZe-O1s7-MaPt-eQWG1R\n  PV Status             allocatable\n  Total PE / Free PE    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2559")]),s._v(" / "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n  PV Name               /dev/sdb3\n  PV UUID               ydGSmi-81qo-KMDO-jULF-UMSa-znYO-XbeIKF\n  PV Status             allocatable\n  Total PE / Free PE    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2559")]),s._v(" / "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2558")]),s._v("\n\n  PV Name               /dev/sdc1    \t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#新的PV")]),s._v("\n  PV UUID               Ph1ARr-Jxod-HyGH-dr4r-eTjc-v8PM-fD1536\n  PV Status             allocatable\n  Total PE / Free PE    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2559")]),s._v(" / "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2559")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br")])]),n("h3",{attrs:{id:"_7-2-更换-pv"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-更换-pv"}},[s._v("#")]),s._v(" 7.2. 更换 PV")]),s._v(" "),n("p",[s._v("移动数据")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ pvmove /dev/sdb2 /dev/sdc1\n  /dev/sdb2: Moved: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.46")]),s._v("%\n  /dev/sdb2: Moved: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v("%\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("从卷组移除物理卷")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ vgreduce vg0 /dev/sdb2\n  Removed "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/sdb2"')]),s._v(" from volume group "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vg0"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"_7-3-删除物理卷"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-删除物理卷"}},[s._v("#")]),s._v(" 7.3. 删除物理卷")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ pvremove /dev/sdb2\n  Labels on physical volume "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/sdb2"')]),s._v(" successfully wiped.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("blockquote",[n("p",[s._v("就变成了块设备")])]),s._v(" "),n("h2",{attrs:{id:"_8-移动卷组"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-移动卷组"}},[s._v("#")]),s._v(" 8. 移动卷组")]),s._v(" "),n("blockquote",[n("p",[s._v("在真实环境的，可能会遇见各种原因，逻辑卷需要需要从一台服务器转移到另外一台服务器上，硬盘的直接转移逻辑卷是识别不到的")])]),s._v(" "),n("h3",{attrs:{id:"_8-1-导出卷组"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-导出卷组"}},[s._v("#")]),s._v(" 8.1. 导出卷组")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("umount")]),s._v(" /data\n 将逻辑卷变为非激活状态\n$ lvchange -a n /dev/vg0/lv0\n-a :activate\n 将VG更改为导出状态\n$ vgexport vg0\n  Volume group "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vg0"')]),s._v(" successfully exported\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("blockquote",[n("p",[s._v("导出状态，可以为 VG 提供一些保护机制，防止被意外使用")])]),s._v(" "),n("h3",{attrs:{id:"_8-2-导入卷组"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-导入卷组"}},[s._v("#")]),s._v(" 8.2. 导入卷组")]),s._v(" "),n("p",[s._v("然后将硬盘插入另外一台服务器，或者将存储映射到另外一台服务器。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("硬盘识别到之后，扫描物理卷\n$ pvscan\n  PV /dev/sda2   VG centos          lvm2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("58.00")]),s._v(" GiB / "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.00")]),s._v(" MiB free"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  PV /dev/sdb1    is "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" exported VG vg0 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.00")]),s._v(" GiB / "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.00")]),s._v(" GiB free"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  PV /dev/sdb3    is "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" exported VG vg0 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.00")]),s._v(" GiB / "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.99")]),s._v(" GiB free"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  PV /dev/sdc1    is "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" exported VG vg0 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.00")]),s._v(" GiB / "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    free"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  Total: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("82.99")]),s._v(" GiB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" / "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" use: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("82.99")]),s._v(" GiB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" / "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" no VG: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v(" 将VG更改为导入状态\n$ vgimport vg0\n  Volume group "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vg0"')]),s._v(" successfully imported\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ lvscan\n  ACTIVE            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/dev/centos/root'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50.00")]),s._v(" GiB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" inherit\n  ACTIVE            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/dev/centos/swap'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.00")]),s._v(" GiB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" inherit\n  inactive          "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/dev/vg0/lv0'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.00")]),s._v(" GiB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" inherit\n$ lvchange -a y /dev/vg0/lv0\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_8-3-挂载查看"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-3-挂载查看"}},[s._v("#")]),s._v(" 8.3. 挂载查看")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" -a\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" -h\nFilesystem               Size  Used Avail Use% Mounted on\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n/dev/mapper/vg0-lv0      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".8G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".1G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".2G  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("77")]),s._v("% /data\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);